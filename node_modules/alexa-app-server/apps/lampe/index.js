module.change_code = 1;
'use strict';

var alexa = require( 'alexa-app' );
var app = new alexa.app( 'lampe' );
const request = require('request');
var yes = true;
app.launch(function(req, res) {
	res.say('sag eine Farbe')
	res.shouldEndSession(false, 'Sag eine Farbe');
} );


app.error = function( exception, request, response ) {
	console.log(exception)
	console.log(request);
	console.log(response);
	response.say('Sorry da ist was schief gelaufen' + error.message);
};

app.intent('lamp',
  {
  "slots":
			{"FARBE":"AMAZON.Color"},
	"utterances":[
			"Stell meine Lampe auf {FARBE}",
			"Lampe auf {FARBE}",
			"{FARBE}",
			"nach {FARBEN}",
			"Lass meine Lampe in {FARBE} leuchten"]
  },
  function(req,res) {
    var farbe = req.slot('FARBE');
		farbe = farbe.toLowerCase();
		var red = 0;
		var green = 0;
		var blue = 0;
    switch(farbe){
			case "rot":
				red = 255;
				break;
			case "blau":
				blue = 255;
				break;
			case "grün":
				green = 255;
				break;
			case "gelb":
				red = 255;
				green = 255;
				break;
			case "orange":
				red = 255;
				green = 100;
				break;
			case "lila":
				red = 139;
				blue = 139;
				break;
			case "weiß":
				red = 255;
				green = 255;
				blue = 255;
				break;
			case "mintgrün":
				red = 100;
				green = 255;
				blue = 080
				break;
			case "aus":
				red = 0;
				green = 0;
				blue = 0;
				break;
			default:
				yes = false;
		}
		var link = "";
		if(red == 0){
			link = link + "000";
		}
		else if (red == 255){
			link = link + "255";
		}
		else if (red == 139){
			link = link + "139";
		}
		else if (red == 100){
			link = link + "100";
		}
		if(green == 0){
			link = link + "000";
		}
		else if(green == 255){
			link = link + "255";
		}
		else if(green == 140){
			link = link + "140";
		}
		else if (green == 100){
			link = link + "100";
		}
		if(blue == 0){
			link = link + "000";
		}
		else if(blue == 255){
			link = link +"255";
		}
		else if(blue == 139){
			link = link + "139";
		}
		else if(blue == 080){
			link = link + "080";
		}
		if(yes == true){
				var request = require('request');
				request.get("http://79.247.245.221/"+link, function (error, response, body) {
		    if (!error && response.statusCode == 200) {

		    }
		});
}
else{

}
});
app.intent('help',
	{
		"utterances":[
				"Ich brauche Hilfe",
				"Hilfe"
		]

	},
	function(req, res){
		res.say("Ich kenne die Farben Rot, Blau, Grün, Gelb, Orange, Lila und Weiß.");
	}


)
module.exports = app;
